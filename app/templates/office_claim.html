{% extends "base.html" %}
{% block content %}

<div class="card">
  <h2>Office view: Claim #{{ claim.id }}</h2>

  <div class="actions">
    <form method="get" action="/claims/{{ claim.id }}">
      <button type="submit">Open safe view</button>
    </form>
    <form method="get" action="/report/{{ claim.lost_report_id }}">
      <button type="submit">Lost report</button>
    </form>
    <form method="get" action="/report/{{ claim.found_report_id }}">
      <button type="submit">Found report</button>
    </form>
  </div>

  <div class="meta" style="margin-top:12px;">
    <div>
      <b>Status:</b>
      {% if claim.status == "approved" %}
        <span class="badge badge-ok">APPROVED</span>
      {% elif claim.status == "rejected" %}
        <span class="badge badge-danger">REJECTED</span>
      {% else %}
        <span class="badge badge-warn">PENDING</span>
      {% endif %}
      {% if claim.is_settled %}
        <span class="badge closed">SETTLED</span>
      {% endif %}
    </div>
    <div><b>Created:</b> {{ claim.created_at }}</div>
  </div>

  <div class="sub" style="margin-top:10px;">
    Lost: #{{ claim.lost_report_id }} — {{ claim.lost_title or "" }}<br />
    Found: #{{ claim.found_report_id }} — {{ claim.found_title or "" }}
  </div>
</div>

<div class="card">
  <h3>Claimant details (office only)</h3>
  <div class="kv">
    <div><b>Name</b></div><div>{{ claim.claimer_name or "—" }}</div>
    <div><b>Phone</b></div><div>{{ claim.claimer_phone or "—" }}</div>
    <div><b>NID</b></div><div>{{ claim.claimer_nid or "—" }}</div>
    <div><b>User ID</b></div><div>{{ claim.claimer_user_id or "—" }}</div>
  </div>
</div>

<div class="card">
  <h3>Proof text (raw)</h3>
  <pre class="mono">{{ claim.proof_text }}</pre>
</div>

<div class="card">
  <h3>Disputes on this claim</h3>

  <ul class="clean">
    {% for d in disputes %}
      <li>
        <div style="display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;">
          <div><b>Dispute #{{ d.id }}</b> <span class="sub">• {{ d.created_at }}</span></div>
          <div class="sub">
            Reporter:
            {{ d.reporter_name if d.reporter_name else "—" }}
            {% if d.reporter_phone %} — {{ d.reporter_phone }}{% endif %}
            {% if d.reporter_user_id %} (user_id {{ d.reporter_user_id }}){% endif %}
          </div>
        </div>
        <pre class="mono" style="margin-top:10px;">{{ d.reason }}</pre>
      </li>
    {% else %}
      <li>No disputes for this claim.</li>
    {% endfor %}
  </ul>
</div>

{% endblock %}
